{% extends 'base.html' %}
{% load static %}

{% block content %}
<header class="masthead">
    <div class="text-center">
        <h1 class="section-heading text-uppercase">MÚSICA</h1>
    </div>
</header>

<div class="container my-4">
    <div class="list-group list-group-flush">
        {% for cancion in canciones %}
        <div class="row list-group-item align-items-center py-3 g-2">
            <!-- Audio Player Hidden -->
            <audio id="audio-{{ cancion.id }}" src="{{ cancion.archivo_audio.url }}"></audio>
            
            <div class="col-3 col-md-2 col-lg-1">
                {% if cancion.album and cancion.album.portada %}
                <img src="{{ cancion.album.portada.url }}" 
                     class="img-fluid rounded-2 shadow-sm" 
                     alt="Portada de {{ cancion.album.titulo }}">
                {% else %}
                <img src="{% static 'assets/img/default_album.png' %}" 
                     class="img-fluid rounded-2 opacity-75" 
                     alt="Álbum no disponible">
                {% endif %}
            </div>

            <div class="col-7 col-md-8 col-lg-9">
                <a href="{% url 'musica:cancion_detalle' cancion.id %}" class="text-decoration-none text-dark">
                    <div class="fw-bold fs-5 titulo-cancion">{{ cancion.titulo }}</div>
                    <div class="text-muted">{{ cancion.artista.nombre }}</div>
                </a>
            </div>

            <div class="col-2 col-md-2 col-lg-2 text-end">
                <button class="btn btn-link text-dark play-button" 
                        data-cancion-id="{{ cancion.id }}"
                        aria-label="Reproducir/Pausar">
                    <i class="fas fa-play fa-lg"></i>
                </button>
            </div>
            
            <div class="col-12 col-md-12">
                <div class="d-flex justify-content-between mt-2">
                    <span class="badge bg-secondary">{{ cancion.categoria }}</span>
                    <small class="text-muted">
                        {% if cancion.album %}
                        <i class="fas fa-compact-disc me-2"></i>{{ cancion.album.titulo }}
                        {% else %}
                        Sin álbum asociado
                        {% endif %}
                    </small>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="text-center py-5 bg-dark rounded-3">
            <i class="fas fa-music fa-3x text-muted mb-3"></i>
            <h4 class="text-muted">No hay canciones disponibles</h4>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}